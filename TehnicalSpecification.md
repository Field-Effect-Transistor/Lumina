# **Технічне Завдання**

## 1. Назва проєкту

**Lumina**

## 2. Опис проєкту

Програмне забезпечення для спрощення розгортання, управління та підключення до безпечних VPN-мереж на базі OpenVPN. Система складається з серверної частини для автоматизації налаштувань та управління доступом, та клієнтської частини для зручного отримання конфігурацій та встановлення з'єднання.

## 3. Мета проєкту

Розробити комплексне програмне рішення, що дозволяє користувачам легко створювати приватні VPN-мережі, керувати доступом користувачів та груп, і автоматично отримувати необхідні конфігураційні файли для підключення. Мета – абстрагуватися від складності ручного налаштування OpenVPN та PKI (Public Key Infrastructure).

## 4. Мова розробки

C/C++ / CMake / Shell

## 5. Структура системи

### 5.1. Серверна частина (Lumina Control Server)

*   **Управління VPN-інстансом:**
    *   Взаємодія з системним процесом OpenVPN для запуску, зупинки та перезавантаження конфігурації.
    *   Конфігурація OpenVPN з використанням топології `subnet` та директорії `client-config-dir` (CCD) для призначення статичних IP-адрес.
    *   Автоматичне управління списком відкликаних сертифікатів (CRL) через інтеграцію з `easyrsa` або подібним інструментом PKI.
*   **Управління користувачами та автентифікацією:**
    *   Реєстрація користувачів у системі (email, пароль) з обов'язковим підтвердженням по email.
    *   Безпечна авторизація користувачів через захищений TLS-канал.
    *   Реалізація системи сесій з використанням короткоживучих **Access Token** (JWT) та довгоживучих **Refresh Token** для автоматичного відновлення сесії.
    *   Безпечне зберігання паролів користувачів та груп з використанням надійних алгоритмів хешування (наприклад, Argon2id13 з `libsodium`).
    *   Централізоване зберігання всієї інформації про користувачів, групи, токени та призначені IP-адреси в базі даних SQLite.
*   **Управління групами та доступом:**
    *   Надання користувачам можливості створювати власні ізольовані VPN-групи.
    *   Управління членством у групах (додавання/видалення користувачів).
    *   Динамічне управління правилами мережевого доступу на рівні сервера за допомогою `iptables` та `ipset`:
        *   Політика за замовчуванням: повна ізоляція всіх клієнтів один від одного.
        *   Спеціальні правила: дозволити комунікацію між членами однієї групи, але заборонити між різними групами.
*   **Генерація клієнтських конфігурацій:**
    *   Автоматична генерація унікальних пар ключ/сертифікат для кожного користувача на стороні сервера.
    *   Формування та передача клієнту готового `.ovpn` файлу з вбудованими сертифікатами та ключами після успішної авторизації.

### 5.2. Клієнтська частина (Lumina Client)

*   **Взаємодія з сервером управління:**
    *   Встановлення безпечного TLS-з'єднання (з використанням `QSslSocket`) з сервером управління для всіх операцій.
    *   Надання графічного інтерфейсу (GUI) для реєстрації та авторизації в системі.
    *   Автоматичне відновлення сесії за допомогою збереженого Refresh Token.
*   **Отримання та управління VPN-з'єднанням:**
    *   Автоматичне отримання персоналізованого `.ovpn` файлу з сервера після входу.
    *   Збереження отриманої конфігурації на локальному диску.
    *   Взаємодія з локально встановленим клієнтом OpenVPN для ініціації та розриву VPN-з'єднання (наприклад, через виклик системних команд).
*   **Інтерфейс користувача:**
    *   Відображення списку доступних груп, до яких належить користувач.
    *   Інтерфейс для створення нових груп та управління членством у групах, власником яких є користувач.
    *   Відображення поточного статусу VPN-з'єднання (підключено/відключено).

## 6. Основні функції

*   **Реєстрація та вхід:** Користувач може створити акаунт та безпечно увійти в систему.
*   **Автоматичне налаштування VPN:** Після входу клієнт автоматично отримує все необхідне для підключення до VPN.
*   **Запуск VPN-з'єднання:** Клієнт може ініціювати VPN-з'єднання одним кліком.
*   **Управління групами:** Користувач може створювати власні приватні групи, запрошувати в них інших користувачів системи та керувати доступом.

## 7. Нефункціональні вимоги

*   **Безпека:**
    *   Весь управляючий трафік між клієнтом та сервером має бути зашифрований за допомогою TLS.
    *   Трафік користувачів всередині VPN має бути зашифрований за допомогою OpenVPN.
*   **Сумісність:** Пріоритетною платформою для сервера та клієнта є Linux. Можливість компіляції та запуску на Windows є бажаною.
*   **Масштабованість:** Архітектура має дозволяти додавання нових користувачів та груп без значних змін.
*   **Інтерфейс:** Реалізація базового, інтуїтивно зрозумілого GUI для клієнтської частини.

## 8. Інструменти та бібліотеки

*   **VPN:** OpenVPN.
*   **PKI:** Easy-RSA або вбудовані можливості OpenSSL.
*   **Серверна мережева частина:** C++ з Boost.Asio (для реалізації TCP/TLS сервера).
*   **Клієнтська частина (GUI та мережа):** C++ з Qt6 (включаючи `QtNetwork` з `QSslSocket`).
*   **Криптографія (хешування, токени):** `libsodium`.
*   **Обмін даними:** JSON (з використанням Boost.JSON на сервері та `QJson` на клієнті).
*   **База даних:** SQLite3.
*   **Мережевий екран (сервер):** `iptables` та `ipset`.
*   **Надсилання Email (сервер):** `libcurl`.
*   **Система збірки:** CMake, Ninja.

## 9. Очікуваний результат

Готовий до використання програмний комплекс, що складається з серверного та клієнтського додатків, який дозволяє користувачам швидко розгортати та підключатися до ізольованих VPN-мереж. Система має забезпечувати централізоване управління користувачами, групами та правилами доступу, мінімізуючи необхідність ручного втручання в конфігураційні файли OpenVPN та `iptables`.